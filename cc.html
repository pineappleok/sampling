
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8"/>
    <title>Java后端WebSocket的Tomcat实现</title>
</head>
<body>
    Welcome<br/><input id="text" type="text"/>
    <button onclick="send()">发送消息</button>
    <hr/>
    <button onclick="closeWebSocket()">关闭WebSocket连接</button>
    <hr/>
    <div id="message"></div>
</body>

<script type="text/javascript">
    var tree = [
    { name: 'node1' },
    { name: 'node2', children: [{ name: 'node-2-1' }, { name: 'node2-2' }] },
    { name: 'node3', children: [{ name: 'node-3-1', children: [{ name: 'node3-1-1' }] }, { name: 'node3-2' }] }
];
var key = 'test'
function parseJson(arr) {
    arr = arr.slice()
    function toParse(arr) {
        arr.forEach(function (item) {
            if (item.children && Array.isArray(item.children)) {
                item[key] = item.children
                toParse(item[key])
            }
            delete item.children
        })
        return arr
    }
    return toParse(arr)
}

console.log('parseJson',parseJson(tree));

function parseJson2(arr,jsonkey,newkey,children) {
    arr = arr.slice()
    function toParse(arr) {
        arr.forEach(function (item) {
            if (item[jsonkey]) {
                item[newkey] = item[jsonkey]
                if(Array.isArray(item[children])){
                    toParse(item[children])
                }
            }
            delete item[jsonkey]
        })
        return arr
    }
    return toParse(arr)
}
var arr=[
    {
      "id": "1",
      "name": "系统管理",
      "description": null,
      "checked": false,
      "children": [
        {
          "id": "11",
          "name": "菜单管理",
          "description": null,
          "checked": false,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 1,
          "isMenu": 1,
          "enable": 1,
          "pid": "1"
        },
        {
          "id": "12",
          "name": "账号管理",
          "description": null,
          "checked": false,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 2,
          "isMenu": 1,
          "enable": 1,
          "pid": "1"
        },
        {
          "id": "13",
          "name": "角色管理",
          "description": null,
          "checked": false,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 3,
          "isMenu": 1,
          "enable": 1,
          "pid": "1"
        },
        {
          "id": "14",
          "name": "部门管理",
          "description": null,
          "checked": false,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 4,
          "isMenu": 1,
          "enable": 1,
          "pid": "1"
        },
        {
          "id": "15",
          "name": "日志管理",
          "description": null,
          "checked": false,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 5,
          "isMenu": 1,
          "enable": 1,
          "pid": "1"
        }
      ],
      "code": null,
      "url": null,
      "icon": null,
      "sort": 1,
      "isMenu": 1,
      "enable": 1,
      "pid": "-1"
    },
    {
      "id": "2",
      "name": "模板管理",
      "description": null,
      "checked": false,
      "children": [
        {
          "id": "21",
          "name": "功能点功能集管理",
          "description": null,
          "checked": false,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 1,
          "isMenu": 1,
          "enable": 1,
          "pid": "2"
        },
        {
          "id": "22",
          "name": "演示产品模板管理",
          "description": null,
          "checked": false,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 2,
          "isMenu": 1,
          "enable": 1,
          "pid": "2"
        },
        {
          "id": "23",
          "name": "演示视频管理",
          "description": null,
          "checked": false,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 3,
          "isMenu": 1,
          "enable": 1,
          "pid": "2"
        },
        {
          "id": "24",
          "name": "行业管理管理",
          "description": null,
          "checked": false,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 4,
          "isMenu": 1,
          "enable": 1,
          "pid": "2"
        }
      ],
      "code": null,
      "url": null,
      "icon": null,
      "sort": 2,
      "isMenu": 1,
      "enable": 1,
      "pid": "-1"
    },
    {
      "id": "3",
      "name": "IOT管理",
      "description": null,
      "checked": false,
      "children": [
        {
          "id": "31",
          "name": "客户管理",
          "description": null,
          "checked": false,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 1,
          "isMenu": 1,
          "enable": 1,
          "pid": "3"
        },
        {
          "id": "32",
          "name": "产品管理",
          "description": null,
          "checked": false,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 2,
          "isMenu": 1,
          "enable": 1,
          "pid": "3"
        },
        {
          "id": "33",
          "name": "数据统计分析",
          "description": null,
          "checked": false,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 3,
          "isMenu": 1,
          "enable": 1,
          "pid": "3"
        }
      ],
      "code": null,
      "url": null,
      "icon": null,
      "sort": 3,
      "isMenu": 1,
      "enable": 1,
      "pid": "-1"
    },
    {
      "id": "4",
      "name": "客服管理",
      "description": null,
      "checked": false,
      "children": null,
      "code": null,
      "url": null,
      "icon": null,
      "sort": 4,
      "isMenu": 1,
      "enable": 1,
      "pid": "-1"
    },
    {
      "id": "5",
      "name": "消息与审核",
      "description": null,
      "checked": false,
      "children": [
        {
          "id": "51",
          "name": "新建消息",
          "description": null,
          "checked": false,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 1,
          "isMenu": 1,
          "enable": 1,
          "pid": "5"
        },
        {
          "id": "52",
          "name": "项目审核",
          "description": null,
          "checked": false,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 2,
          "isMenu": 1,
          "enable": 1,
          "pid": "5"
        },
        {
          "id": "53",
          "name": "用户反馈",
          "description": null,
          "checked": false,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 3,
          "isMenu": 1,
          "enable": 1,
          "pid": "5"
        }
      ],
      "code": null,
      "url": null,
      "icon": null,
      "sort": 5,
      "isMenu": 1,
      "enable": 1,
      "pid": "-1"
    }
  ];
var newarr=parseJson2(arr,'name','title','children');
console.log(arr);
console.log(newarr);
</script>
</html>