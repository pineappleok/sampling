
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8"/>
    <title>Java后端WebSocket的Tomcat实现</title>
</head>
<body>
    Welcome<br/><input id="text" type="text"/>
    <button onclick="send()">发送消息</button>
    <hr/>
    <button onclick="closeWebSocket()">关闭WebSocket连接</button>
    <hr/>
    <div id="message"></div>
</body>

<script type="text/javascript">
var arr2=[
    {
      "id": "1",
      "name": "系统管理",
      "description": null,
      "checked": true,
      "children": [
        {
          "id": "11",
          "name": "菜单管理",
          "description": null,
          "checked": true,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 1,
          "isMenu": 1,
          "enable": 1,
          "pid": "1"
        },
        {
          "id": "12",
          "name": "账号管理",
          "description": null,
          "checked": false,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 2,
          "isMenu": 1,
          "enable": 1,
          "pid": "1"
        },
        {
          "id": "13",
          "name": "角色管理",
          "description": null,
          "checked": false,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 3,
          "isMenu": 1,
          "enable": 1,
          "pid": "1"
        },
        {
          "id": "14",
          "name": "部门管理",
          "description": null,
          "checked": true,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 4,
          "isMenu": 1,
          "enable": 1,
          "pid": "1"
        },
        {
          "id": "15",
          "name": "日志管理",
          "description": null,
          "checked": true,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 5,
          "isMenu": 1,
          "enable": 1,
          "pid": "1"
        }
      ],
      "code": null,
      "url": null,
      "icon": null,
      "sort": 1,
      "isMenu": 1,
      "enable": 1,
      "pid": "-1"
    },
    {
      "id": "2",
      "name": "模板管理",
      "description": null,
      "checked": true,
      "children": [
        {
          "id": "21",
          "name": "功能点功能集管理",
          "description": null,
          "checked": true,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 1,
          "isMenu": 1,
          "enable": 1,
          "pid": "2"
        },
        {
          "id": "22",
          "name": "演示产品模板管理",
          "description": null,
          "checked": false,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 2,
          "isMenu": 1,
          "enable": 1,
          "pid": "2"
        },
        {
          "id": "23",
          "name": "演示视频管理",
          "description": null,
          "checked": false,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 3,
          "isMenu": 1,
          "enable": 1,
          "pid": "2"
        },
        {
          "id": "24",
          "name": "行业管理管理",
          "description": null,
          "checked": false,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 4,
          "isMenu": 1,
          "enable": 1,
          "pid": "2"
        }
      ],
      "code": null,
      "url": null,
      "icon": null,
      "sort": 2,
      "isMenu": 1,
      "enable": 1,
      "pid": "-1"
    },
    {
      "id": "3",
      "name": "IOT管理",
      "description": null,
      "checked": true,
      "children": [
        {
          "id": "31",
          "name": "客户管理",
          "description": null,
          "checked": false,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 1,
          "isMenu": 1,
          "enable": 1,
          "pid": "3"
        },
        {
          "id": "32",
          "name": "产品管理",
          "description": null,
          "checked": true,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 2,
          "isMenu": 1,
          "enable": 1,
          "pid": "3"
        },
        {
          "id": "33",
          "name": "数据统计分析",
          "description": null,
          "checked": false,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 3,
          "isMenu": 1,
          "enable": 1,
          "pid": "3"
        }
      ],
      "code": null,
      "url": null,
      "icon": null,
      "sort": 3,
      "isMenu": 1,
      "enable": 1,
      "pid": "-1"
    },
    {
      "id": "4",
      "name": "客服管理",
      "description": null,
      "checked": true,
      "children": null,
      "code": null,
      "url": null,
      "icon": null,
      "sort": 4,
      "isMenu": 1,
      "enable": 1,
      "pid": "-1"
    },
    {
      "id": "5",
      "name": "消息与审核",
      "description": null,
      "checked": false,
      "children": [
        {
          "id": "51",
          "name": "新建消息",
          "description": null,
          "checked": true,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 1,
          "isMenu": 1,
          "enable": 1,
          "pid": "5"
        },
        {
          "id": "52",
          "name": "项目审核",
          "description": null,
          "checked": false,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 2,
          "isMenu": 1,
          "enable": 1,
          "pid": "5"
        },
        {
          "id": "53",
          "name": "用户反馈",
          "description": null,
          "checked": false,
          "children": null,
          "code": null,
          "url": null,
          "icon": null,
          "sort": 3,
          "isMenu": 1,
          "enable": 1,
          "pid": "5"
        }
      ],
      "code": null,
      "url": null,
      "icon": null,
      "sort": 5,
      "isMenu": 1,
      "enable": 1,
      "pid": "-1"
    }
  ];
function chooseChecked(arr,children) {
    arr = arr.slice();
    let checkedArr=[];
    function toParse(arr) {
        arr.forEach(function (item) {
            if(item.id){
                if (item.checked) {
                    checkedArr.push(item.id);
                }
                if(Array.isArray(item[children])){
                    toParse(item[children])
                }
            }
            delete item.id;
        })
        return checkedArr
    }
    return toParse(arr)
}
var newarr2=chooseChecked(arr2,'children');
console.log(arr2);
console.log(newarr2);
</script>
</html>